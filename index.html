<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ficha DaggerHeart</title>
    <link rel="stylesheet" href="style.css?v=3">
    <link rel="preconnect" href="https://fonts.googleapis.com">
</head>

<body>

    <img alt="Imagem de uma paisagem de fantasia" src="header1.jpg">

    <br><br>

    <!--CABEÇALHO DO PERSONAGEM-->
    <div class="inicio">
        <div>
            <p>NOME:  </p>
            <input type="text" data-save="nomechar">
        </div>

        <div>
            <p>PRONOMES:  </p>
            <input type="text" data-save="pronomechar" style="max-width: 50px;">
        </div>

        <div>
            <p>ORIGEM:  </p>
            <input type="text" data-save="herancachar">
        </div>

        <div>
            <p>SUBCLASSES:  </p>
            <input type="text" data-save="subclassechar" style="width: 340px;">
        </div>

        <div class="nivel">
            <p>NIVEL:  </p>
            <input type="number" data-save="levelchar">
        </div>
    </div>

    <br> <br>

    <!--ATRIBUTOS-->
    <div class="atributos">
        <div>
            <p>EVASÃO  </p>
            <input type="number" min="0" placeholder="0" data-save="evasao">
        </div>

        <div class="armor">
            <div>
                <p>ARMADURA  </p>
                <input type="number" min="0" placeholder="0" data-save="armadura">
            </div>

            <div class="check">
                <input type="checkbox" data-save="armcheck1">
                <input type="checkbox" data-save="armcheck2">
                <input type="checkbox" data-save="armcheck3">
                <input type="checkbox" data-save="armcheck4">
                <input type="checkbox" data-save="armcheck5">
                <input type="checkbox" data-save="armcheck6">
                <input type="checkbox" data-save="armcheck7">
                <input type="checkbox" data-save="armcheck8">
                <input type="checkbox" data-save="armcheck9">
                <input type="checkbox" data-save="armcheck10">
                <input type="checkbox" data-save="armcheck11">
                <input type="checkbox" data-save="armcheck12">
            </div>
        </div>

        

        <div class="atributo">
            <button onclick="rolardados('agilidade')">AGI</button>
            <input type="number" id="agilidade" placeholder="0" data-save="agi">
        </div>

        <div class="atributo">
            <button onclick="rolardados('forca')">FOR</button>
            <input type="number" id="forca" placeholder="0" data-save="for">
        </div>

        <div class="atributo">
            <button onclick="rolardados('destreza')">DEX</button>
            <input type="number" id="destreza" placeholder="0" data-save="fin">
        </div>

        <div class="atributo">
            <button onclick="rolardados('instinto')">INS</button>
            <input type="number" id="instinto" placeholder="0" data-save="ins">
        </div>

        <div class="atributo">
            <button onclick="rolardados('presenca')">PRE</button>
            <input type="number" id="presenca" placeholder="0" data-save="pre">
        </div>

        <div class="atributo">
            <button onclick="rolardados('sabedoria')">SAB</button>
            <input type="number" id="sabedoria" placeholder="0" data-save="con">
        </div>

        <div class="atributo">
            <p>ADICIONAR VANTAGEM</p>
            <input type="checkbox" id="vantagem" data-save="vantagem">
        </div>

    </div>

    <br> <br>

    <!--DIV COM AS DUAS COLUNAS E O RESTO DAS COISAS-->
    <div class="main">

        <!--ESQUERDA-->
        <div class="esqdir">

            

            <div style="border: 2px solid rgba(136, 136, 136, 0.808); border-radius: 10px; padding: 7px;">

                <h2>SAÚDE</h2> <hr>

                <p style="text-align: center;">VIDA MÁXIMA:
                    <input type="number" data-save="vidamax" style="width: 30px; font-size: 20px;">
                    <input type="checkbox" data-save="vidacheck1">
                    <input type="checkbox" data-save="vidacheck2">
                    <input type="checkbox" data-save="vidacheck3">
                    <input type="checkbox" data-save="vidacheck4">
                    <input type="checkbox" data-save="vidacheck5">
                    <input type="checkbox" data-save="vidacheck6">
                    <input type="checkbox" data-save="vidacheck7">
                    <input type="checkbox" data-save="vidacheck8">
                    <input type="checkbox" data-save="vidacheck9">
                    <input type="checkbox" data-save="vidacheck10">
                    <input type="checkbox" data-save="vidacheck11">
                    <input type="checkbox" data-save="vidacheck12">
                </p>
                
            </br>

            <p style="text-align: center;">STRESS MÁXIMO:
                    <input type="number" data-save="stressmax" style="width: 30px; font-size: 20px;">
                    <input type="checkbox" data-save="stresscheck1">
                    <input type="checkbox" data-save="stresscheck2">
                    <input type="checkbox" data-save="stresscheck3">
                    <input type="checkbox" data-save="stresscheck4">
                    <input type="checkbox" data-save="stresscheck5">
                    <input type="checkbox" data-save="stresscheck6">
                    <input type="checkbox" data-save="stresscheck7">
                    <input type="checkbox" data-save="stresscheck8">
                    <input type="checkbox" data-save="stresscheck9">
                    <input type="checkbox" data-save="stresscheck10">
                    <input type="checkbox" data-save="stresscheck11">
                    <input type="checkbox" data-save="stresscheck12">
                </p>
                
            </br>
                
                <div class="dano">
                        
                            <p>MAIOR
                            <input type="number" data-save="danomaior" style="width: 30px; font-size: 20px;"> </p>
                        
                        
                            <p>SEVERO
                            <input type="number" data-save="danosevero" style="width: 30px; font-size: 20px;"> </p>
                        
                </div>
            </div>

            <BR>
                <br>


            <div style="border: 2px solid rgba(136, 136, 136, 0.808); border-radius: 10px; padding: 7px; text-align: center;">
                <h2>ESPERANÇA</h2> <hr>
                <div class="checkesp">

                <input type="checkbox" data-save="esperancacheck1">
                <input type="checkbox" data-save="esperancacheck2">
                <input type="checkbox" data-save="esperancacheck3"> 
                <input type="checkbox" data-save="esperancacheck4">
                <input type="checkbox" data-save="esperancacheck5">
                <input type="checkbox" data-save="esperancacheck6">

                </div>        
            

            <br>
            
            <textarea placeholder="Aspecto de Esperança" data-save="recursoesperanca" style="min-height: 75px; min-width: 100%; max-width: fit-content;"></textarea>

            </div>

            <br>
            <br>

            <div style="border: 2px solid rgba(136, 136, 136, 0.808); border-radius: 10px; padding: 7px;">
                <h2>EXPERIÊNCIAS</h2> <hr>
                
                <input type="text" data-save="exp1" style="min-width: 99%;"> <br>
                <input type="text" data-save="exp2" style="min-width: 99%;"> <br>
                <input type="text" data-save="exp3" style="min-width: 99%;"> <br>
                <input type="text" data-save="exp4" style="min-width: 99%;"> <br>
                <input type="text" data-save="exp5" style="min-width: 99%;"> <br>

                
                
            
            </div>

            <br>
            <br>

            <div style="text-align: center; border: 2px solid rgba(136, 136, 136, 0.808); border-radius: 10px; padding: 7px;"">
            <h2>OURO</h2> <hr>
            <p>PUNHADOS
                <input type="checkbox" data-save="punhado1">
                <input type="checkbox" data-save="punhado2">
                <input type="checkbox" data-save="punhado3">
                <input type="checkbox" data-save="punhado4">
                <input type="checkbox" data-save="punhado5">
                <input type="checkbox" data-save="punhado6">
                <input type="checkbox" data-save="punhado7">
                <input type="checkbox" data-save="punhado8">
                <input type="checkbox" data-save="punhado9">
            </p>

            <p>SACOS
                <input type="checkbox" data-save="saco1">
                <input type="checkbox" data-save="saco2">
                <input type="checkbox" data-save="saco3">
                <input type="checkbox" data-save="saco4">
                <input type="checkbox" data-save="saco5">
                <input type="checkbox" data-save="saco6">
                <input type="checkbox" data-save="saco7">
                <input type="checkbox" data-save="saco8">
                <input type="checkbox" data-save="saco9">
            </p>

            <p>BAÚS
                <input type="checkbox" data-save="bau1">
                <input type="checkbox" data-save="bau2">
                <input type="checkbox" data-save="bau3">
                <input type="checkbox" data-save="bau4">
                <input type="checkbox" data-save="bau5">
                <input type="checkbox" data-save="bau6">
                <input type="checkbox" data-save="bau7">
                <input type="checkbox" data-save="bau8">
                <input type="checkbox" data-save="bau9">
            </p>
            </div>

            <br>
            <br>

            <div style="border: 2px solid rgba(136, 136, 136, 0.808); border-radius: 10px; padding: 7px;text-align: center;">
                <h2>ASPECTO DE CLASSE</h2> <hr>
                
                <textarea data-save="recursoclasse" style="min-height: 145px; min-width: 100%; max-width:fit-content;"></textarea>
            </div>

            

        </div>

        

        

        
        
        <!--DIREITA-->
        <div class="esqdir">
            <div style="border: 2px solid rgba(136, 136, 136, 0.808); border-radius: 10px; padding: 7px; text-align: center;">
                <h2>ARMAS ATIVAS</h2>
                <hr>
                <p style="text-align: start;">PROFICIÊNCIA 
                    <input type="checkbox" data-save="proficiencia1">
                    <input type="checkbox" data-save="proficiencia2">
                    <input type="checkbox" data-save="proficiencia3">
                    <input type="checkbox" data-save="proficiencia4">
                    <input type="checkbox" data-save="proficiencia5">
                    <input type="checkbox" data-save="proficiencia6">
                </p>

                
                <br>
                
                <div>
                    <p>PRIMÁRIA</p>
                    <input type="text" data-save="nomearma1" placeholder="Nome" style="max-width: 400px;">
                    <input type="text" data-save="alcancearma1" placeholder="Alcance">
                    <input type="text" data-save="dadoarma1" placeholder="Dado e Tipo">
                    <br>
                    <br>
                    <textarea data-save="recursoarma1" style="min-width: 99%; max-width: 99%; min-height: 45px;"></textarea>


                </div>

            
            </br>

                <div>
                    <p>SECUNDÁRIA</p>
                    <input type="text" data-save="nomearma2" placeholder="Nome" style="max-width: 400px;">
                    <input type="text" data-save="alcancearma2" placeholder="Alcance">
                    <input type="text" data-save="dadoarma2" placeholder="Dado e Tipo">
                    <br>
                    <br>
                    <textarea data-save="recursoarma2" style="min-width: 99%; max-width: 99%; min-height: 45px;"></textarea>

                </div>

            </div>

            <br>

            <div style="border: 2px solid rgba(136, 136, 136, 0.808); border-radius: 10px; padding: 7px; text-align: center;">
                <h2>ARMADURA ATIVA</h2> <hr>
                <input type="text" data-save="nomearmadura" placeholder="Nome" style="max-width: 400px;">
                <input type="text" data-save="limitearmadura" placeholder="Limite">
                <input type="text" data-save="pontosarmadura" placeholder="Pontos">
                <br>
                <br>
                <textarea data-save="recursoarmadura" style="min-width: 99%; max-width: 99%; min-height: 45px;"></textarea>


            </div>


            <br>

            <div style="border: 2px solid rgba(136, 136, 136, 0.808);
            border-radius: 10px; padding: 7px; text-align: center;">
                <h2>INVENTÁRIO</h2> <hr>
                
                <textarea data-save="inventario" style="min-width: 99%; max-width: 99%; min-height: 200px;"></textarea>

                <br>
                <br>

                <div style="border: 2px solid rgba(136, 136, 136, 0.808);
            border-radius: 10px; padding: 7px; text-align: center;">
                    <p>ARMA DO INVENTÁRIO</p>
                    <input type="text" data-save="nomearmainv1" placeholder="Nome" style="max-width: 400px;">
                    <input type="text" data-save="alcancearmainv1" placeholder="Alcance">
                    <input type="text" data-save="dadoarmainv1" placeholder="Dado e Tipo">
                    <br>
                    <br>
                    <textarea data-save="recursoarmainv1" style="min-width: 99%; max-width: 99%; min-height: 45px;"></textarea>


                </div>

                <br>

                <div style="border: 2px solid rgba(136, 136, 136, 0.808);
            border-radius: 10px; padding: 7px; text-align: center;">
                    <p>ARMA DO INVENTÁRIO</p>
                    <input type="text" data-save="nomearmainv2" placeholder="Nome" style="max-width: 400px;">
                    <input type="text" data-save="alcancearmainv2" placeholder="Alcance">
                    <input type="text" data-save="dadoarmainv2" placeholder="Dado e Tipo">
                    <br>
                    <br>
                    <textarea data-save="recursoarmainv2" style="min-width: 99%; max-width: 99%; min-height: 45px;"></textarea>

                </div>


            </div>

        </div>

        <div>
            
        </div>
    </div>

        <div style="display:flex; justify-content: center; gap:10px">

            <button id="exportar">EXPORTAR</button>
            <button id="importar">IMPORTAR</button>
            <input type="file" id="fileInput" accept=".json" hidden>

        </div>


        <div id="popupOverlay" class="popup-overlay">
            <div class="popup">
                <h2 id="popupTitulo"></h2>
                <p id="popupTexto"></p>

                <button onclick="fecharPopup()">Fechar</button>
            </div>
        </div>






    <script>

        function rolardados(atr) {

            const bonus = parseInt(document.getElementById(atr).value) || 0;

            const vant = document.getElementById("vantagem");

            let dadoextra = 0;

            if(vant.checked){
                dadoextra = rolarD6();
            }

            const hope = rolarD12();
            const fear = rolarD12();
            const result = hope + fear + bonus + dadoextra;

            const titulo = atr.toUpperCase() + "<br><br>";

            let mensagem = `${result} | `;

            if (hope === fear) {
                mensagem += "CRÍTICO!<br><br>";
            } else if (hope > fear) {
                mensagem += "ESPERANÇA<br><br>";
            } else {
                mensagem += "MEDO<br><br>";
            }

            mensagem += `Hope: ${hope} | Fear: ${fear}`;
            if(dadoextra != 0){
                mensagem += ` | Vantagem: ${dadoextra}`
            }

            abrirPopup(titulo, mensagem);
        }


        function rolarD12() {
            return Math.floor(Math.random() * 12) + 1;
        }

        function rolarD6() {
            return Math.floor(Math.random() * 6) + 1;
        }



        function abrirPopup(titulo, texto) {
            document.getElementById("popupTitulo").innerHTML = titulo;
            document.getElementById("popupTexto").innerHTML = texto;
            document.getElementById("popupOverlay").classList.add("ativo");
        }

        function fecharPopup() {
            document.getElementById("popupOverlay").classList.remove("ativo");
        }








        function coletarDados() {
            const dados = {};

            document.querySelectorAll("[data-save]").forEach(el => {
                const chave = el.dataset.save;

                if (el.type === "checkbox") {
                    dados[chave] = el.checked; // boolean
                } else if (el.type === "number") {
                    dados[chave] = Number(el.value); // number
                } else {
                    dados[chave] = el.value; // text e textarea
                }
            });

            return dados;
        }

        document.getElementById("exportar").addEventListener("click", () => {
            const dados = coletarDados();

            const json = JSON.stringify(dados, null, 2);
            const blob = new Blob([json], { type: "application/json" });

            const a = document.createElement("a");
            a.href = URL.createObjectURL(blob);
            a.download = "ficha.json";
            a.click();
        });

        document.getElementById("importar").addEventListener("click", () => {
            document.getElementById("fileInput").click();
        });

        document.getElementById("fileInput").addEventListener("change", e => {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();

            reader.onload = () => {
                const dados = JSON.parse(reader.result);
                aplicarDados(dados);
            };

            reader.readAsText(file);
        });

        function aplicarDados(dados) {
            document.querySelectorAll("[data-save]").forEach(el => {
            const chave = el.dataset.save;
                if (!(chave in dados)) return;

                if (el.type === "checkbox") {
                    el.checked = dados[chave];
                } else {
                    el.value = dados[chave];
                }
            });
        }



    </script>

</body>
</html>